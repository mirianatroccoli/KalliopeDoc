Applicazioni Kalliope
=====

.. _installation:

KalliopeCTI 4
------------
.. warning::
    È disponibile il manuale KalliopeCTI 4 versione 4.5.23 per l'installazione e la configurazione del client al seguente `link <https://www.kalliope.com/downloads/>`_.
    Per scaricare il client riferito al proprio sistema operativo, visitare il sito `<www.kalliope.com>`_, nel menù in alto troveremo Support --> Documenti e Downloads e di conseguenza la sezione Applicazioni
    
Descrizione del servizio
+++++++
KalliopeCTI 4 (d’ora in poi denominato semplicemente come KCTI 4) è un’applicazione accessoria del centralino VoIP KalliopePBX V4 che consente di facilitarne la fruizione dei servizi telefonici e l’accesso alle informazioni in esso contenute.

KCTI 4 (nelle versioni “Free”, “Pro” e “Phone”) è disponibile per sistemi operativi Windows e macOS. Con l’acquisto di ogni licenza KCTI 4 Pro e Phone è inclusa una licenza KCTI Mobile per l’utilizzo dell’app mobile KCTI su dispositivi Android.

Il manuale utente dell’app KalliopeCTI mobile è disponibile al seguente link.

Di seguito riassumiamo la lista delle principali funzionalità delle diverse versioni.


   +-------------------------------------+----------------+-------------+----------------+-----------------+
   |                                     | KCTI 4 Free    | KCTI 4 Pro  | KCTI 4 Phone   | KCTI 4 Mobile   |
   +=====================================+================+=============+================+=================+
   | Rubrica interni                     | Si             | Si          | Si             | Si              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Rubrica condivisa                   | Si             | Si          | Si             | Si              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Storico Chiamate                    | Si             | Si          | Si             | Si              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Click-to-call                       | Si             | Si          | Si             | Si              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Avviso chiamate in ingresso         | Si             | Si          | Si             | Si              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Instant Messaging                   | Si             | Si          | Si             | Si              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Presence                            | Si             | Si          | Si             | Si              |   
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Apertura URL personalizzati         | Si             | Si          | Si             | No              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Accesso VoiceMail                   | Si             | Si          | Si             | Si              |  
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Servizio Copy-to-call               | Si             | Si          | Si             | No              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Sincronizzazione contatti Outlook   | No             | Si          | Si             | No              | 
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | BLF                                 | No             | Si          | Si             | Si              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Composizione numero                 | No             | Si          | Si             | Si              |  
   +-------------------------------------+----------------+-------------+----------------+-----------------+ 
   | Trasferimento senza offerta         | No             | Si(2)       | Si             | Si              | 
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Trasferimento con offerta           | No             | Si(2)       | Si             | Si              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Do not Disturb                      | No             | Si(2)       | Si             | No              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Registro chiamata                   | No             | Si(2)       | Si             | No              |  
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Inoltro incondizionato chiamata     | No             | Si(2)       | Si             | No              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Parcheggio chiamata                 | No             | Si(2)       | Si             | No              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Prelievo chiamata                   | No             | Si(2)       | Si             | No              |   
   +-------------------------------------+----------------+-------------+----------------+-----------------+ 
   | Forking to Mobile                   | No             | Si          | Si             | Si              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Statistiche code di attesa          | Si             | Si          | Si             | Si              | 
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Modalità Supervisor                 | Si(2)          | Si(2)       | Si(2)          | No              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Messa in pausa selettiva            | Si(2)          | Si(2)       | Si(2)          | No              | 
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Supporti schermi touch              | No             | No          | No             | Si              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   | Integrazione rubrica mobile         | No             | No          | No             | Si              |
   +-------------------------------------+----------------+-------------+----------------+-----------------+
   

1 Disponibile solo in abbinamento con un telefono Snom o Yealink

2 Disponibile solo in abbinamento con il modulo Kalliope Call Center

Download e installazione
+++++
KCTI 4 è scaricabile liberamente dall'area `Download <https://www.kalliope.com/downloads/>`_ del sito ufficiale di KalliopePBX.

Tramite il Pannello di Configurazione sarà cura dell’utente selezionare quale modalità di utilizzo attivare di volta in volta, previa verifica della disponibilità sul centralino KalliopePBX V4 della relativa licenza. Per questo motivo KCTI 4 Free, Pro e Phone non sono altro che tre modalità applicative dello stesso software.

**Nota**: L’installazione non prevede l’inserimento di alcun codice di attivazione. L’applicazione verifica in automatico la presenza sul centralino KalliopePBX della corretta licenza di utilizzo a ciascun avvio.


Ad eccezione della modalità applicativa KCTI 4 Free, che non richiede alcuna licenza, KCTI 4 Pro e Phone richiedono l’installazione sul centralino KalliopePBX V4 di una specifica licenza per ciascuna postazione. La licenza per KCTI 4 Phone consente di utilizzare anche la modalità applicativa KCTI 4 Pro. Dal pannello di Configurazione, l’utente ha la possibilità di selezionare la modalità applicativa desiderata.

Per la procedura di configurazione delle licenze KCTI 4 Pro o KCTI 4 Phone sul centralino KalliopePBX V4 si faccia riferimento alla sezione Licenze_.

**Requisiti di Sistema**:

Windows:

- Sistema operativo Windows 8 o successivo
- Scheda audio presente (per la modalità KCTI Phone)
- 2 GB di RAM
- 100 MB di spazio per l’installazione

MAC:

- macOS: BigSur (11.0), Catalina (10.15), Mojave (10.14)
- recommended: apple hardware from 2013 and later

Linux:

- Ubuntu 18.04 o 20.04

Per installare l’applicazione in ambiente Windows è sufficiente lanciare l’eseguibile e seguire le istruzioni.

**NOTA**: Nel caso in cui il servizio SIP della centrale sia esposto su un IP diverso da quello di connessione CTI, o su una porta diversa da quella standard (5060) è necessario impostare sul KalliopePBX uno o entrambi i seguenti placeholder personalizzati all'interno del pannello di Provisioning: **%%_KPHONE_SIP_REGISTRAR_IP%%** e **%%_KPHONE_SIP_REGISTRAR_PORT%%**. Questa configurazione è normalmente necessaria quando il servizio SIP viene esposto al pubblico tramite un Session Border Controller che utilizza un IP diverso da quello su cui è raggiungibile la centrale, mentre è non necessario se PBX e SBC sono nattati sullo stesso IP pubblico, ciascuno per le porte di sua competenza (TCP/5039 e TCP/5222 per le componenti CTI e Chat, verso Kalliope, e SIP + RTP per la fonia, verso l'SBC).

Manuale Utente
++++++
Il manuale KalliopeCTI 4 versione 4.5.23 per l'installazione e la configurazione del client è disponibile al seguente `link <https://www.kalliope.com/downloads/>`_.

Parametri speciali del file INI del KalliopeCTI
++++++
A partire dalla **4.5.18** del KalliopeCTI possono essere aggiunti o modificati direttamente nel **kcti.ini** i seguenti parametri. Nella tabella seguente sono riportati i parametri modificabili con indicata la versione del KalliopeCTI a partire dalla quale il parametro è presente e modificabile.


.. list-table::  
   :widths: 25 25 25 50
   :header-rows: 1

   * - Parametro
     - Valore di esempio
     - Descrizione
     - A partire da (versione KCTI Desktop)
   * - echoCanceller
     - on
     - per abilitare (on) o meno (off) l'echo cancel. Default: on
     - 4.5.23
   * - echoCancellerLmsFilter
     - off
     - Per abilitare (on) o meno (off) il filtro LMS sull'echo cancel. Default: off
     - 4.5.23
   * - echoSuppressor
     - on
     - Per abilitare (on) o meno (off) l'echo suppression. Default: on
     - 4.5.23
   * - suppressorLowerThreshold	
     - 10
     - Per impostare la soglia minima (percentuale) dell'echo suppression. Range valori ammessi: [0, 100]. Default: 10
     - 4.5.23
   * - suppressorUpperThreshold
     - 40
     - Per impostare la soglia massima (percentuale) dell'echo suppression. Range valori ammessi: [0, 100]. Default: 40
     - 4.5.23
   * - suppressorDivider
     - 15
     - Per impostare il divisore dell'echo suppression. Range valori ammessi: [2, 50]. Default: 15
     - 4.5.23
   * - suppressorConvergenceMillis
     - 4000
     - Per impostare la convergenza (millisecondi) dell'echo suppression. Range valori ammessi: [1000, 120000]. Default: 4000
     - 4.5.23
   * - chatKeepAliveSendIntervalSecs
     - 120
     - per i messaggi di ping XMPP, default 2 minuti
     - 4.5.19
   * - contactsRefreshTimeoutSecs
     - 600
     - per l'aggiornamento del phonebook, default 10 minuti
     - 4.5.18
   * - cdrRefreshTimeoutSecs
     - 90
     - per l'aggiornamento del cdr/voicemail, default 1 minuto e mezzo
     - 4.5.18
   * - identitiesRefreshTimeoutSecs
     - 300
     - per l'aggiornamento degli account, default 5 minuti
     - 4.5.18
   * - queueStatsRefreshTimeoutSecs
     - 300
     - per l'aggiornamento delle code, default 5 minuti
     - 4.5.18
   * - codecOrderRefreshTimeoutSecs
     - 30
     - per l'aggiornamento dei codec, default 30 secondi
     - 4.5.18   
   * - excludedOutlookFolders
     - Cartelle pubbliche;Public folders;Cache;Lync;Skype
     - elenco stringhe contenute nelle folders di Outlook da escludere comprese le relative subfolders dall'import dei contatti, come separatore va usato il ;
     - 4.5.18    
   * - queueNames
     - Coda1;Coda2
     - elenco dei nomi esatti delle code da visualizzare nel Supervisor Panel, come separatore va usato il ;
     - 4.5.15


kcti.ini si trova nella stessa directory dei trace (quindi AppData\Roaming\KCTI4 sotto il percorso d'utente).

Si ricorda poi che il kcti.ini va modificato manualmente quando il Kcti non è in esecuzione



API
+++++
Il client mette a disposizione all'utente delle API per poter effettuare delle azioni in maniera programmatica senza l'utilizzo dell'interfaccia grafica.
Le azioni disponibili sono:

- chiamare un numero
- chiudere la chiamata corrente
- trasferire con o senza offerta di una chiamata in corso
- mettersi/togliersi dalla pausa su tutte le code
- abilitare/disabilitare il DND
- recuperare i dati della chiamata attiva

Per le versioni dalla 4.5.0 in su è disponibile una collection `Postman <https://www.postman.com/>`_ per testare le API del KalliopeCTI client scaricabile dal seguente link: KalliopeCTI Client (vers.4.5.x) postman collection È possibile inoltre scaricare in formato pdf un manuale operativo delle API del Kalliope CTI client dal questo `link <https://www.kalliope.com/wiki/kcti4_client_api_4.5.pdf/>`_.




KalliopeCTI Mobile
------------

Introduzione
+++++++
Per chi ha la necessità di essere sempre reperibile, Kalliope ha pensato l’app KalliopeCTI mobile per sistemi Android e iOS.

KalliopeCTI mobile app è un prodotto opzionale che permette di accedere ai servizi telefonici e di UC anche fuori dall'ufficio, semplicemente tramite il tuo numero di interno e utilizzando le linee aziendali.

Per garantire la stabilità e la migliore qualità della conversazione, KalliopeCTI mobile ti offre l’opportunità di scegliere come gestire le tue chiamate: in base alla disponibilità del traffico dati potrai decidere se utilizzare per la conversazione la rete GSM o usare l’app in modalità softphone.

KalliopeCTI mobile permette quindi di telefonare in tre modalità diverse:

- Click-to-call: la chiamata viene gestita attraverso il telefono fisso associato all’interno
- Call-back: l’utente chiama da smartphone utilizzando le linee Kalliope
- Softphone: grazie all’integrazione di un motore telefonico SIP, lo smartphone si registrerà direttamente su KalliopePBX come un qualsiasi client IP.

È possibile scaricare KalliopeCTI mobile direttamente da `Playstore <https://play.google.com/store/apps/details?id=it.netresults.kalliopeservice&pli=1>`_ e `App Store <https://apps.apple.com/it/app/kalliope-cti/id1108203678>`_.

Visualizza l'informativa sul `Trattamento dei dati personali degli utenti <https://www.kalliope.com/images/NetResults_GDPR_-_Informativa_APP.21.03.pdf>`_

**Nota**: Ad ogni interno è possibile associare **un solo** account KCTI Mobile.

*jpg*


Configurazione preliminare
++++++
Per poter utilizzare l'app mobile KalliopeCTI è necessario predisporre le seguenti configurazioni:

- Nelle impostazioni "Account" abilitare la voce "KCTI Mobile App".
    - **NOTA**: deve essere abilitato all'uso dell'app mobile **un solo account per interno**.
- Assegnare una licenza KalliopeCTI all'utente secondo questa logica:
    - Licenza KalliopeCTI Pro -> abilita l'uso dell'app mobile KalliopeCTI solo in modalità callback (GSM™)
    - Licenza KalliopeCTI Phone -> abilita l'uso dell'app mobile KalliopeCTI sia in modalità softphone che callback

- Nello scenario in cui si voglia accedere con l'app mobile dall'esterno della rete aziendale è necessario pubblicare le seguenti porte del KalliopePBX (**NOTA BENE: Si raccomanda di non esporre il servizio SIP della centrale sul pubblico in modo diretto**, raggiungibile da IP arbitrari, ma di utilizzare un Session Border Controller in grado di proteggere adeguatamente la centrale dai tentativi di intrusione provenienti dall'esterno):
    - Porta **TCP 5039** per i servizi CTI
    - Porta **TCP 5222** per i servizi chat XMPP
    - Porta **UDP per il servizio SIP** come configurata nel pannello "Impostazioni SIP" (solo nel caso di modalità softphone, valore di default '5060')
    - Intervallo **porte UDP 10000-20000** per i flussi RTP (solo nel caso di modalità softphone)

Inoltre **è indispensabile che il KalliopePBX possa inviare i messaggi i server di push notification di Apple e Google** e quindi dovrà essere garantita la raggiungibilità da parte del KalliopePBX dei seguenti indirizzi:

- iOS: **api.push.apple.com** (HTTPS, porta TCP/443)
- Android: **fcm.googleapis.com** (HTTPS, porta TCP/443)

Visto che questi host possono risolvere nel tempo IP diversi, è raccomandato che non siano applicati filtri al traffico HTTPS uscente da KalliopePBX.

Inoltre, affinché i dispositivi mobili su cui è in esecuzione l'APP KalliopeCTI Mobile possano ricevere le notifiche, è necessario che questi siano connessi e raggiungibili dai servizi di invio. Per ulteriori informazioni sui flussi che devono essere garantiti, fare riferimento alla documentazione ufficiale di:

- Google: https://firebase.google.com/docs/cloud-messaging/concept-options#messaging-ports-and-your-firewall
- Apple: https://support.apple.com/en-ph/HT203609


**NOTA**: Per evitare comportamenti anomali nell'invio ai client delle notifiche di chiamata in arrivo/terminata è necessario che ciascun utente sia loggato su un solo device, perché ad ogni account SIP (e quindi utente associato) può essere associato un unico token Firebase (utilizzato per identificare il destinatario delle notifiche).

**NOTA**: Nel caso in cui il servizio SIP della centrale sia esposto su un IP diverso da quello di connessione CTI, o su una porta diversa da quella standard (5060) è necessario impostare sul KalliopePBX uno o entrambi i seguenti placeholder personalizzati all'interno del pannello di Provisioning: **%%_KPHONE_SIP_REGISTRAR_IP%%** e **%%_KPHONE_SIP_REGISTRAR_PORT%%** . Questa configurazione è normalmente necessaria quando il servizio SIP viene esposto al pubblico tramite un Session Border Controller che utilizza un IP diverso da quello su cui è raggiungibile la centrale, mentre è non necessario se PBX e SBC sono nattati sullo stesso IP pubblico, ciascuno per le porte di sua competenza (TCP/5039 e TCP/5222 per le componenti CTI e Chat, verso Kalliope, e SIP + RTP per la fonia, verso l'SBC).

Le informazioni dettagliate specifiche riguardo la configurazione e l'uso dell'app KalliopeCTI Mobile nei due sistemi operativi Android e IOS sono disponibili sulle seguenti pagine dedicate:

- Manuale KalliopeCTI Mobile app Android
- Manuale KalliopeCTI Mobile app IOS

Kalliope Attendant Console
------------

Introduzione
+++++
KalliopeATC (d’ora in poi denominato semplicemente KATC) è un’applicazione accessoria del centralino VoIP KalliopePBX che affianca alle funzionalità del KalliopePhone quelle del posto operatore.
KATC è disponibile per S.O. Windows.
Di seguito riassumiamo la lista delle principali funzionalità:

.. list-table::  
   :widths: 25
   :header-rows: 1

   * - Parametro     
   * - Funzionalità Kalliope Attendant Console
   * - Rubrica interni
   * - Rubrica condivisa
   * - CDR
   * - Avviso chiamate in ingresso
   * - Chat
   * - Presence
   * - Apertura URL personalizzati sulle chiamate in ingresso
   * - Accesso Voice Mail
   * - Copy to Call
   * - Drop to Call
   * - BLF
   * - Trasferimento senza offerta
   * - Trasferimento con offerta
   * - Statistiche code d'attesa
   * - Classificazione chiamate in ingresso
   * - Do Not Disturb
   * - Registrazione chiamata
   * - Inoltro incondizionato chiamata
   * - Parcheggio della chiamata
   * - Prelievo di chiamata
   * - Prelievo con invito
   * - Forking to Mobile
   * - Supporto schermi touch
   * - Trasferimento chiamate Drag&Drop

Kalliope Call Center
------------
